window.File&&window.FileReader&&window.FileList&&window.Blob;var mouseX=0.0,mouseY=0,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2;function toggleDiv(e){"none"==document.getElementById(e).style.display?document.getElementById(e).style.display="":document.getElementById(e).style.display="none"}function onDocumentKeyDown(e){keyCode=e.which}function onDocumentKeyUp(e){keyCodeUp=e.which}function nextTetra(){texFlag+=1,23<texFlag&&(texFlag=0),camera.remove(objects[1]),addTetraF()}function prevTetra(){texFlag-=1,texFlag<0&&(texFlag=23),camera.remove(objects[1]),addTetraF()}function deleteX(){console.log(TaddD+" TaddD");var e=TaddD;0==TaddD&&(TaddD=1),1==e&&(TaddD=0),console.log(TaddD+" TaddD")}savedFiles[0]=". ",userLocalName[0]="NONE",init(),animate();var callback=function(){objects[cii].rotation.x=gamma+angleOb/2},callbacky=function(){objects[cii].rotation.y=gamma+angleOb/2},callbackz=function(){objects[cii].rotation.z=gamma+angleOb/2};function keyboardX(){var e=objects[cii].rotation.x;console.log("XRotate"),setTimeout(callback,300),objects[cii].rotation.x=e+angleOb/2}function keyboardY(){var e=objects[cii].rotation.y;console.log("YRotate"),setTimeout(callbacky,300),objects[cii].rotation.y=e+angleOb/2}function keyboardZ(){var e=objects[cii].rotation.z;console.log("ZRotate"),setTimeout(callbackz,300),objects[cii].rotation.z=e+angleOb/2}function LoadUserFile(e){scene.remove(octa);e=e;var o=localStorage.getItem(e);retrievedObjectA=JSON.parse(o),cii=retrievedObjectA[0].NormalT,TColour=retrievedObjectA[0].TColour,rotX=retrievedObjectA[0].rotX,rotY=retrievedObjectA[0].rotY,rotZ,retrievedObjectA[0].rotZ,possiX=retrievedObjectA[0].possiX,possiY=retrievedObjectA[0].possiY,possiZ=retrievedObjectA[0].possiZ,TFlagNum=retrievedObjectA[0].TFlagNum,TFlagNum[cii+1]=1,vv0x=retrievedObjectA[0].vv0x,vv0y=retrievedObjectA[0].vv0y,vv0z=retrievedObjectA[0].vv0z,vv1x=retrievedObjectA[0].vv1x,vv1y=retrievedObjectA[0].vv1y,vv1z=retrievedObjectA[0].vv1z,vv2x=retrievedObjectA[0].vv2x,vv2y=retrievedObjectA[0].vv2y,vv2z=retrievedObjectA[0].vv2z,vv3x=retrievedObjectA[0].vv3x,vv3y=retrievedObjectA[0].vv3y,vv3z=retrievedObjectA[0].vv3z,mirX=retrievedObjectA[0].mirX,mirY=retrievedObjectA[0].mirY,mirXY=retrievedObjectA[0].mirXY,ciiL=retrievedObjectA[0].NormalT,cii=0,i=2,iiL=-11111;for(var t=loadingF=1;t<=ciiL;t+=1)cii+=1,addTetraFlag=retrievedObjectA[0].TFlagNum[cii],addTetraLC(cii,e),render();ciiB=scene.children.length,cii=0,i=2,iiL=-11111,ciiB=scene.children.length;for(t=1;t<=ciiL;t+=1)cii+=1,addTetraFlag=retrievedObjectA[0].TFlagNum[cii],addTetraL(cii),render();cii=ciiL,iiL=0}function LoadUserFileC(e,t){localStorage?console.log("LocalStorage is supported!"):console.log("No support. Use a fallback such as browser cookies or store on the server.");var o=e,a=localStorage.getItem(o);retrievedObjectA=JSON.parse(a),ciiL=retrievedObjectA[0].NormalT;console.log(t.length+"obj length"),console.log(t[1].position.x+"obj x pos"),console.log(retrievedObjectA[0].TColour[2]+"outloop obj color"),console.log(scene.children.length+"children scene 8"),ciiA=scene.children.length;scene.traverse(function(e){if(e instanceof THREE.Object3D&&e.userData<990){materials[e.userData]=material15;var o=retrievedObjectA[0].TColour[e.userData];materials[e.userData].color.setHex("0x"+o),lambert=new THREE.MeshLambertMaterial({color:materials[e.userData].color,map:texture2}),t[e.userData].traverse(function(e){e.material=lambert}),1==mirX[e.userData]&.8<Math.abs(possiX[e.userData])&&t[e.userData+1e3].traverse(function(e){e.material=lambert}),1==mirY[e.userData]&.8<Math.abs(possiY[e.userData])&&t[e.userData+2e3].traverse(function(e){e.material=lambert}),1==mirXY[e.userData]&.8<Math.abs(possiX[e.userData])&.8<Math.abs(possiY[e.userData])&&t[e.userData+3e3].traverse(function(e){e.material=lambert})}}),ciiL=retrievedObjectA[0].NormalT-1,cii=ciiL,iiL=0}function download(e,o,t){var a=new Blob([e],{type:t});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,o);else{var r=document.createElement("a"),i=URL.createObjectURL(a);r.href=i,r.download=o,document.body.appendChild(r),r.click(),setTimeout(function(){document.body.removeChild(r),window.URL.revokeObjectURL(i)},0)}}function sendMail(e){var o=e,t="mailto:tetra.dg@gmail.com?cc=theuns@sun.ac.za&subject="+escape("OBJ12321")+"&body="+o;window.location.href=t}function exportToObj(e,o,t,a,r){localStorage?console.log("LocalStorage is supported!"):console.log("No support. Use a fallback such as browser cookies or store on the server."),localStorage.clear(),parameters.Load2=activeFiles,parameters.LoadC=activeFiles,parameters.DelFile=activeFiles,parameters.uLocalName=userLocalName;for(var i=0;i<Object.keys(gui.__folders).length;i++)for(var c=Object.keys(gui.__folders)[i],n=0;n<gui.__folders[c].__controllers.length;n++)gui.__folders[c].__controllers[n].updateDisplay();var s=[{current:current,userLocalName:userLocalName,numUsers:a,savedFiles:savedFiles}];userObject=JSON.stringify(s,null,100);localStorage.setItem("USERS",userObject),sentObjectA=[{NormalT:cii,TColour:TColour,rotX:rotX,rotY:rotY,rotZ:rotZ,possiX:possiX,possiY:possiY,possiZ:possiZ,TFlagNum:TFlagNum,vv0x:vv0x,vv0y:vv0y,vv0z:vv0z,vv1x:vv1x,vv1y:vv1y,vv1z:vv1z,vv2x:vv2x,vv2y:vv2y,vv2z:vv2z,vv3x:vv3x,vv3y:vv3y,vv3z:vv3z,mirX:mirX,mirY:mirY,mirXY:mirXY}],sampleObject=JSON.stringify(sentObjectA,null,100);var l=new Blob([cii,", cii,","\r\n",TColour,",  TColour,","\r\n",rotX,", rotX,","\r\n",rotY,", rotY ","\r\n",rotZ,", rotZ ","\r\n",possiX,", possiX ","\r\n",possiY,", possiY ","\r\n",possiZ,", possiZ ","\r\n",TFlagNum,", TFlagNum ","\r\n",ciiX,", ciiX, ","\r\n",TColourX,",  TColourX, ","\r\n",rotXX,", rotX_Xsym, ","\r\n",rotYX,", rotYX ","\r\n",rotZX,", rotZX ","\r\n",possiXX,", possiXX ","\r\n",possiYX,", possiYX ","\r\n",possiZX,", possiZX ","\r\n",TFlagNumX,", TFlagNumX ","\r\n",ciiY,", ciiY, ","\r\n",TColourY,",  TColourY, ","\r\n",rotXY,", rotX_Ysym, ","\r\n",rotYY,", rotYY ","\r\n",rotZY,", rotZY ","\r\n",possiXY,", possiXY ","\r\n",possiYY,", possiYY ","\r\n",possiZY,", possiZY ","\r\n",TFlagNumY,", TFlagNumY ",ciiXY,", ciiXandY, ","\r\n",TColourXY,",  TColourXandY, ","\r\n",rotXXY,", rotX_XandYsym, ","\r\n",rotYXY,", rotYXY ","\r\n",rotZXY,", rotZXY ","\r\n",possiXXY,", possiXXY ","\r\n",possiYXY,", possiYXY ","\r\n",possiZXY,", possiZXY ","\r\n",TFlagNumXY,", TFlagNumXY "],{type:"text/plain;charset=utf-8"}),E=t;localStorage.setItem(E,sampleObject);for(var d=rotX,m=rotY,T=rotZ,v=1;v<=cii;v+=1)d[v]=180*rotX[v]/Math.PI-90,m[v]=180*rotY[v]/Math.PI,T[v]=180*rotZ[v]/Math.PI;var b="NormalT ="+cii+";TColour =["+TColour.toString().substring(8)+"];rotX =["+d.toString().substring(5)+"];rotY =["+m.toString().substring(5)+"];rotZ =["+T.toString().substring(5)+"];possiX =["+possiX.toString().substring(2)+"];possiY =["+possiY.toString().substring(2)+"];possiZ =["+possiZ.toString().substring(2)+"];TFlagNum =["+TFlagNum.toString().substring(2)+"];vv0x =["+vv0x.toString().substring(2)+"];vv0y =["+vv0y.toString().substring(2)+"];vv0z =["+vv0z.toString().substring(2)+"];vv1x =["+vv1x.toString().substring(2)+"];vv1y =["+vv1y.toString().substring(2)+"];vv1z =["+vv1z.toString().substring(2)+"];vv2x =["+vv2x.toString().substring(2)+"];vv2y =["+vv2y.toString().substring(2)+"];vv2z =["+vv2z.toString().substring(2)+"];vv3x =["+vv3x.toString().substring(2)+"];vv3y =["+vv3y.toString().substring(2)+"];vv3z =["+vv3z.toString().substring(2)+"];mirX =["+mirX+"];mirY =["+mirY+"];mirXY =["+mirXY+"];";sampleObject=JSON.stringify(b,null,100);var w=sampleObject.toString().replace(['"'],[""]);download(w=w.slice(0,-1),E,"text/csv"),console.log("savedxxxxxx"+E),camera.remove(objects[1]),camera.remove(objects[999]),scene.remove(objects[1]),scene.remove(objects[999]);var R="",g=0;for(i=2;i<cii+1;i++){var H;if(R+="newmtl Material."+(i-1+g)+"\n",R+="Ns 96.0000\n",R+="Ni 1.5000\n",R+="d 1.0000\n",R+="Tr 0.0000\n",R+="Tf 1.0000 1.0000 1.0000\n",R+="illum 2\n",R+="Ka 1.0000 1.0000 1.0000\n",R+="Kd "+((H="0x"+TColour[i])>>16)/255*.8+" "+(H>>8&255)/255*.8+" "+(255&H)/255*.8+" \n",R+="Ks 0.0000 0.0000 0.0000\n",R+="Ke 0.2000 0.2000 0.2000\n",void 0===objects[i+1e3]);else R+="newmtl Material."+(i-1+(g+=1))+"\n",R+="Ns 96.0000\n",R+="Ni 1.5000\n",R+="d 1.0000\n",R+="Tr 0.0000\n",R+="Tf 1.0000 1.0000 1.0000\n",R+="illum 2\n",R+="Ka 1.0000 1.0000 1.0000\n",R+="Kd "+((H="0x"+TColour[i])>>16)/255*.8+" "+(H>>8&255)/255*.8+" "+(255&H)/255*.8+" \n",R+="Ks 0.0000 0.0000 0.0000\n",R+="Ke 0.2000 0.2000 0.2000\n";if(void 0===objects[i+2e3]);else R+="newmtl Material."+(i-1+(g+=1))+"\n",R+="Ns 96.0000\n",R+="Ni 1.5000\n",R+="d 1.0000\n",R+="Tr 0.0000\n",R+="Tf 1.0000 1.0000 1.0000\n",R+="illum 2\n",R+="Ka 1.0000 1.0000 1.0000\n",R+="Kd "+((H="0x"+TColour[i])>>16)/255*.8+" "+(H>>8&255)/255*.8+" "+(255&H)/255*.8+" \n",R+="Ks 0.0000 0.0000 0.0000\n",R+="Ke 0.2000 0.2000 0.2000\n";if(void 0===objects[i+3e3]);else R+="newmtl Material."+(i-1+(g+=1))+"\n",R+="Ns 96.0000\n",R+="Ni 1.5000\n",R+="d 1.0000\n",R+="Tr 0.0000\n",R+="Tf 1.0000 1.0000 1.0000\n",R+="illum 2\n",R+="Ka 1.0000 1.0000 1.0000\n",R+="Kd "+((H="0x"+TColour[i])>>16)/255*.8+" "+(H>>8&255)/255*.8+" "+(255&H)/255*.8+" \n",R+="Ks 0.0000 0.0000 0.0000\n",R+="Ke 0.2000 0.2000 0.2000\n"}var u=new THREE.OBJExporter;count=0;var p=u.parse(scene,count);p="mtllib "+E+".mtl\n"+p,TColour.toString().substring(8),l=new Blob([p],{type:"text/plain"});saveAs(l,E+".obj");l=new Blob([R],{type:"text/plain"});saveAs(l,E+".mtl"),camera.add(objects[1]),camera.add(objects[999])}function loadALL(){if(null===localStorage.getItem("USERS")){numUsers=1,numUserL=0,userLocalName[0]="NONE",savedFiles=[". ","No file"],numSavedFiles=2,current=["NONE","No file",0];var e=[{current:current,userLocalName:["NONE"],numUsers:numUsers,savedFiles:savedFiles}];userObject=JSON.stringify(e,null,100);localStorage.setItem("USERS",userObject),uLocalName=current[0]}}function init(){if(null===localStorage.getItem("USERS"))loadALL();else{var e=localStorage.getItem("USERS"),o=JSON.parse(e);numSavedFiles=o[0].savedFiles.length,numUsers=o[0].userLocalName.length,userLocalName=o[0].userLocalName,current=o[0].current,numUserL=current[2],uLocalName=current[0],savedFiles=o[0].savedFiles,currentFile=current[1]}material11.side=THREE.DoubleSide,floatingDiv=document.createElement("div"),floatingDiv.className="floating",document.body.appendChild(floatingDiv),projector=new THREE.Projector,scene=new THREE.Scene;var t,a=window.innerWidth,r=window.innerHeight,i=a/r;camera=new THREE.PerspectiveCamera(55,i,.01,2e4),camera.up=new THREE.Vector3(0,1,0);var c=new THREE.AudioListener;camera.add(c),cameraLeft=new THREE.PerspectiveCamera(55,i,.01,2e4),cameraLeft.position.set(0,0,3),cameraLeft.position.set(.1,-2.5,-30.195),cameraLeft.lookAt(scene.position),scene.add(cameraLeft),cameraRight=new THREE.PerspectiveCamera(55,i,.01,2e4),cameraRight.position.set(0,0,3),cameraRight.position.set(-.1,-2.5,-30.195),cameraRight.lookAt(scene.position),scene.add(cameraRight),scene.add(camera),scene.background=t,camera.position.set(0,-2.5,-30.195),camera.lookAt(scene.position),Detector.webgl||Detector.addGetWebGLMessage(),Detector.webgl?renderer=new THREE.WebGLRenderer({antialias:!0}):renderer=new THREE.CanvasRenderer,renderer.setClearColor(0),renderer.setSize(a,r),container=document.getElementById("ThreeJS"),renderer.gammaInput=!0,renderer.gammaOutput=!0,container.appendChild(renderer.domElement),document.addEventListener("mousedown",onDocumentMouseDown,!1),document.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("keydown",onDocumentKeyDown,!1),document.addEventListener("keyup",onDocumentKeyUp,!1),document.addEventListener("keyup",function(e){audio.play()}),THREEx.WindowResize(renderer,camera),THREEx.FullScreen.bindKey({charCode:"m".charCodeAt(0)}),controls=new THREE.TrackballControls(camera,renderer.domElement),renderer.domElement.addEventListener("mousedown",onDocumentMouseDown,!1),renderer.domElement.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("keydown",onDocumentKeyDown,!1),document.addEventListener("keyup",onDocumentKeyUp,!1),anaglyphRenderer=new THREE.AnaglyphEffect(renderer,a,r),stereoRenderer=new THREE.StereoEffect(renderer,a,r);new THREE.AmbientLight(12303291);lightsP[0]=new THREE.AmbientLight(16777215),lightsP[0].intensity=3,lightsP[1]=new THREE.PointLight(16777215,1,0),lightsP[2]=new THREE.PointLight(16777215,1,0),lightsP[1].intensity=3,lightsP[2].intensity=3,lightsP[0].position.set(0,200,0),lightsP[1].position.set(100,200,100),lightsP[2].position.set(-100,-200,-100),scene.add(lightsP[0]),scene.add(lightsP[1]),scene.add(lightsP[2]);var n=new THREE.DirectionalLight(16777215,1);n.position.set(1,551,1).normalize(),scene.add(n);new THREE.PointLight(16777215,2,800);var s=new THREE.SphereGeometry(.5,.5,.5),l=new THREE.Color("skyblue"),E=new THREE.Mesh(s,l);E.position.x=0,E.position.y=200,E.position.z=500,ci=1,cii=1,materials[cii]=material15,addTetra();s=new THREE.SphereGeometry(.35,.35,.35);var d=new THREE.Mesh(s,new THREE.MeshBasicMaterial({color:15658734}));scene.add(d),mouseSphere.push(d),renderer.autoClear=!1}function updateGuiT(){parameters.Rainbow=Rainbow,parameters.Load2=savedFiles,parameters.LoadC=savedFiles,parameters.DelFile=savedFiles,parameters.uLocalName=[" ","Create_User"],parameters.uLocalSelect=userLocalName;for(var e=0;e<Object.keys(gui.__folders).length;e++)for(var o=Object.keys(gui.__folders)[e],t=0;t<gui.__folders[o].__controllers.length;t++)gui.__folders[o].__controllers[t].updateDisplay();console.log("should update the gui????")}function addTetra(){var e=new THREE.LoadingManager;e.onProgress=function(e,o,t){};new THREE.ImageLoader(e).load(textures[texFlag],function(e){}),texture2.offset.set(-2.275,-.7),texture2.repeat.set(3.7,3),lambert=new THREE.MeshLambertMaterial({color:material15.color,map:texture2}),lambert=new THREE.MeshLambertMaterial({color:1127338,map:texture2,side:THREE.DoubleSide});var o=new THREE.TextureLoader,t=o.load("roughness_map.jpg"),a=o.load("textures/envmap.png");a.mapping=THREE.SphericalReflectionMapping;new THREE.MeshBasicMaterial({color:65535,wireframe:!0,side:THREE.DoubleSide}),new THREE.MeshBasicMaterial({color:16711680,blending:THREE.AdditiveBlending}),new THREE.MeshLambertMaterial({color:16777215}),new THREE.MeshLambertMaterial({color:16777215}),new THREE.MeshNormalMaterial({}),new THREE.MeshBasicMaterial({envMap:t,side:THREE.DoubleSide}),new THREE.MeshBasicMaterial({envMap:a});0==addTetraFlag&&(console.log("flag1111"),new THREE.OBJLoader(e).load("models/obj/TextLess.obj",function(e){e.material=lambert,e.traverse(function(e){e.material=new THREE.MeshLambertMaterial({color:13243,map:texture2})}),e.scale.x=.99,e.scale.y=.99,e.scale.z=.99,objects[3]=e.clone(),objects[3].material=e.material.clone();Math.PI;var o=Math.floor(window.innerWidth/60);console.log(o);window.innerHeight,objects[3].position.x,objects[3].position.y,objects[3].position.z;objects[3].position.x=0,objects[3].position.y=0,objects[3].position.z=0,objects[3].position.applyMatrix4(camera.matrixWorld),objects[3].position.x=objects[3].position.x+4,objects[3].position.z=objects[3].position.z,objects[3].position.y=objects[3].position.y+5,camera.add(objects[3])}),new THREE.OBJLoader(e).load(designs[0],function(e){e.traverse(function(e){e.material=new THREE.MeshLambertMaterial({color:1127338,map:texture2,side:THREE.DoubleSide})}),e.scale.x=.99,e.scale.y=.99,e.scale.z=.99,objects[2]=e.clone(),objects[2].material=e.material.clone(),objects[1]=e.clone(),objects[1].material=e.material.clone(),object2=e.clone(),object2.material=e.material.clone();Math.PI;var o=Math.floor(window.innerWidth/60);console.log(o);var t=window.innerHeight/80,a=camera.position.x,r=camera.position.y,i=camera.position.z;camera.position.set(0,-2.5,-30.195),objects[1].scale.x=.9,objects[1].scale.y=.9,objects[1].scale.z=.9,objects[1].position.x=0,objects[1].position.y=0,objects[1].position.z=0,objects[1].position.applyMatrix4(camera.matrixWorld),objects[1].position.x=o/20,objects[1].position.z=objects[1].position.z,objects[1].position.y=t,objects[1].rotation.x=Math.PI,camera.add(objects[1]),camera.position.set(a,r,i),console.log(cii+"  numbr"),targetOBJ.push(objects[1]),cii=1;(new THREE.TextureLoader).load("textures/sprite.png"),new THREE.MeshLambertMaterial({color:16711680,vertexColors:THREE.FaceColors,shading:THREE.FlatShading,polygonOffset:!0,polygonOffsetUnits:1,polygonOffsetFactor:1});(v=new THREE.Geometry).vertices=[new THREE.Vector3(0,0,0),new THREE.Vector3(4,0,0),new THREE.Vector3(2,-2,-2),new THREE.Vector3(2,2,-2)],v.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],v.computeFaceNormals(),octa=new THREE.Mesh(v,material11);var c=new THREE.Mesh(v,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));scene.add(c),scene.add(octa),console.log("000 OCTA added"),targetList.push(octa),targetList.push(c);var n=new THREE.Geometry;n.vertices=[new THREE.Vector3(0,0,0),new THREE.Vector3(4,0,0),new THREE.Vector3(2,2,-2),new THREE.Vector3(2,2,2)],n.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],n.computeFaceNormals(),octa2=new THREE.Mesh(n,material11);c=new THREE.Mesh(n,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));scene.add(octa2),targetList.push(octa2),console.log("000 OCTA2 added");var s=new THREE.Geometry;s.vertices=[new THREE.Vector3(0,0,0),new THREE.Vector3(4,0,0),new THREE.Vector3(2,2,2),new THREE.Vector3(2,-2,2)],s.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],s.computeFaceNormals(),octa=new THREE.Mesh(s,material11);c=new THREE.Mesh(s,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));scene.add(octa),console.log("000 OCTA added"),targetList.push(octa);var l=new THREE.Geometry;l.vertices=[new THREE.Vector3(0,0,0),new THREE.Vector3(4,0,0),new THREE.Vector3(2,-2,2),new THREE.Vector3(2,-2,-2)],l.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],l.computeFaceNormals(),octa2=new THREE.Mesh(l,material11);c=new THREE.Mesh(l,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));scene.add(octa2),targetList.push(octa2),console.log("000 OCTA2 added");var E=new THREE.Geometry;E.vertices=[new THREE.Vector3(2,-2,2),new THREE.Vector3(2,-2,-2),new THREE.Vector3(0,0,0),new THREE.Vector3(0,-4,0)],E.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],E.computeFaceNormals(),octa=new THREE.Mesh(E,material11);c=new THREE.Mesh(E,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa.add(c),scene.add(octa),console.log("0005 OCTA added green"),targetList.push(octa);var d=new THREE.Geometry;d.vertices=[new THREE.Vector3(2,-2,-2),new THREE.Vector3(-2,-2,-2),new THREE.Vector3(0,0,0),new THREE.Vector3(0,-4,0)],d.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],d.computeFaceNormals(),octa2=new THREE.Mesh(d,material11);c=new THREE.Mesh(d,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa2.add(c),scene.add(octa2),targetList.push(octa2),console.log("000 OCTA2 added");var m=new THREE.Geometry;m.vertices=[new THREE.Vector3(-2,-2,-2),new THREE.Vector3(-2,-2,2),new THREE.Vector3(0,0,0),new THREE.Vector3(0,-4,0)],m.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],m.computeFaceNormals(),octa=new THREE.Mesh(m,material11);c=new THREE.Mesh(m,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa.add(c),scene.add(octa),console.log("000 OCTA added"),targetList.push(octa);var T=new THREE.Geometry;T.vertices=[new THREE.Vector3(-2,-2,2),new THREE.Vector3(2,-2,2),new THREE.Vector3(0,0,0),new THREE.Vector3(0,-4,0)],T.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],T.computeFaceNormals(),octa2=new THREE.Mesh(T,material11);c=new THREE.Mesh(T,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa2.add(c),scene.add(octa2),targetList.push(octa2),console.log("000 OCTA2 added");var v=new THREE.Geometry,b=new THREE.Geometry;b.vertices=[new THREE.Vector3(2,2,2),new THREE.Vector3(2,2,-2),new THREE.Vector3(0,4,0),new THREE.Vector3(0,0,0)],b.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],b.computeFaceNormals(),octa=new THREE.Mesh(b,material11);c=new THREE.Mesh(b,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa.add(c),scene.add(octa),console.log("000 OCTA added other"),targetList.push(octa);var w=new THREE.Geometry;w.vertices=[new THREE.Vector3(2,2,-2),new THREE.Vector3(-2,2,-2),new THREE.Vector3(0,4,0),new THREE.Vector3(0,0,0)],w.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],w.computeFaceNormals(),octa2=new THREE.Mesh(w,material11);c=new THREE.Mesh(w,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa2.add(c),scene.add(octa2),targetList.push(octa2),console.log("000 OCTA2 added");var R=new THREE.Geometry;R.vertices=[new THREE.Vector3(-2,2,-2),new THREE.Vector3(-2,2,2),new THREE.Vector3(0,4,0),new THREE.Vector3(0,0,0)],R.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],R.computeFaceNormals(),octa=new THREE.Mesh(R,material11);c=new THREE.Mesh(R,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa.add(c),scene.add(octa),console.log("000 OCTA added"),targetList.push(octa);var g=new THREE.Geometry;g.vertices=[new THREE.Vector3(-2,2,2),new THREE.Vector3(2,2,2),new THREE.Vector3(0,4,0),new THREE.Vector3(0,0,0)],g.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],g.computeFaceNormals(),octa2=new THREE.Mesh(g,material11);c=new THREE.Mesh(g,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa2.add(c),scene.add(octa2),targetList.push(octa2),console.log("000 OCTA2 added");var H=new THREE.Geometry;H.vertices=[new THREE.Vector3(-4,0,0),new THREE.Vector3(0,0,0),new THREE.Vector3(-2,-2,-2),new THREE.Vector3(-2,2,-2)],H.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],H.computeFaceNormals(),octa=new THREE.Mesh(H,material11);c=new THREE.Mesh(H,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa.add(c),scene.add(octa),console.log("000 OCTA added"),targetList.push(octa);var u=new THREE.Geometry;u.vertices=[new THREE.Vector3(-4,0,0),new THREE.Vector3(0,0,0),new THREE.Vector3(-2,2,-2),new THREE.Vector3(-2,2,2)],u.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],u.computeFaceNormals(),octa2=new THREE.Mesh(u,material11);c=new THREE.Mesh(u,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa2.add(c),scene.add(octa2),targetList.push(octa2),console.log("000 OCTA2 added");var p=new THREE.Geometry;p.vertices=[new THREE.Vector3(-4,0,0),new THREE.Vector3(0,0,0),new THREE.Vector3(-2,2,2),new THREE.Vector3(-2,-2,2)],p.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],p.computeFaceNormals(),octa=new THREE.Mesh(p,material11);c=new THREE.Mesh(p,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa.add(c),scene.add(octa),console.log("000 OCTA added"),targetList.push(octa);var y=new THREE.Geometry;y.vertices=[new THREE.Vector3(-4,0,0),new THREE.Vector3(0,0,0),new THREE.Vector3(-2,-2,2),new THREE.Vector3(-2,-2,-2)],y.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],y.computeFaceNormals(),octa2=new THREE.Mesh(y,material11);c=new THREE.Mesh(y,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa2.add(c),scene.add(octa2),targetList.push(octa2);var h=new THREE.Geometry;h.vertices=[new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,4),new THREE.Vector3(2,-2,2),new THREE.Vector3(2,2,2)],h.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],h.computeFaceNormals(),octa=new THREE.Mesh(h,material11);c=new THREE.Mesh(h,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa.add(c),scene.add(octa),console.log("000 OCTA added"),targetList.push(octa);var x=new THREE.Geometry;x.vertices=[new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,4),new THREE.Vector3(2,2,2),new THREE.Vector3(-2,2,2)],x.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],x.computeFaceNormals(),octa2=new THREE.Mesh(x,material11);c=new THREE.Mesh(x,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa2.add(c),scene.add(octa2),targetList.push(octa2),console.log("000 OCTA2 added");var f=new THREE.Geometry;f.vertices=[new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,4),new THREE.Vector3(-2,2,2),new THREE.Vector3(-2,-2,2)],f.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],f.computeFaceNormals(),octa=new THREE.Mesh(f,material11);c=new THREE.Mesh(f,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa.add(c),scene.add(octa),console.log("000 OCTA added"),targetList.push(octa);var j=new THREE.Geometry;j.vertices=[new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,4),new THREE.Vector3(-2,-2,2),new THREE.Vector3(2,-2,2)],j.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],j.computeFaceNormals(),octa2=new THREE.Mesh(j,material11);c=new THREE.Mesh(j,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa2.add(c),scene.add(octa2),targetList.push(octa2),console.log("000 OCTA2 added");var M=new THREE.Geometry;M.vertices=[new THREE.Vector3(0,0,-4),new THREE.Vector3(0,0,0),new THREE.Vector3(2,-2,-2),new THREE.Vector3(2,2,-2)],M.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],M.computeFaceNormals(),octa=new THREE.Mesh(M,material11);c=new THREE.Mesh(M,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa.add(c),scene.add(octa),console.log("000 OCTA added"),targetList.push(octa);var F=new THREE.Geometry;F.vertices=[new THREE.Vector3(0,0,-4),new THREE.Vector3(0,0,0),new THREE.Vector3(2,2,-2),new THREE.Vector3(-2,2,-2)],F.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],F.computeFaceNormals(),octa2=new THREE.Mesh(F,material11);c=new THREE.Mesh(F,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa2.add(c),scene.add(octa2),targetList.push(octa2),console.log("000 OCTA2 added");var O=new THREE.Geometry;O.vertices=[new THREE.Vector3(0,0,-4),new THREE.Vector3(0,0,0),new THREE.Vector3(-2,2,-2),new THREE.Vector3(-2,-2,-2)],O.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],O.computeFaceNormals(),octa=new THREE.Mesh(O,material11);c=new THREE.Mesh(O,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa.add(c),scene.add(octa),console.log("000 OCTA added"),targetList.push(octa);var z=new THREE.Geometry;z.vertices=[new THREE.Vector3(0,0,-4),new THREE.Vector3(0,0,0),new THREE.Vector3(-2,-2,-2),new THREE.Vector3(2,-2,-2)],z.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],z.computeFaceNormals(),octa2=new THREE.Mesh(z,material11);c=new THREE.Mesh(z,new THREE.MeshBasicMaterial({color:3342387,wireframe:!0,transparent:!0,opacity:1}));octa2.add(c),scene.add(octa2),targetList.push(octa2),console.log(("000000"+material11.color.getHex().toString(16)).slice(-6)+"gethexcol"),TColour[cii]=("000000"+material11.color.getHex().toString(16)).slice(-6)},function(e){if(e.lengthComputable)e.loaded,e.total},function(e){}));new THREE.OBJLoader;material111=new THREE.MeshLambertMaterial({color:3355443,transparent:!0,opacity:0})}function addTetraLC(e,o){var t=localStorage.getItem(o);retrievedObjectA=JSON.parse(t);retrievedObjectA[0].possiX[e],retrievedObjectA[0].possiY[e],retrievedObjectA[0].possiZ[e],retrievedObjectA[0].rotX[e],retrievedObjectA[0].rotY[e],retrievedObjectA[0].rotZ[e];1==mirX[e]&&(Xsym="ON"),"ON"==Xsym&&(console.log("YayMirX!"),mirX[e]=1),1==mirY[e]&&(Ysym="ON"),"ON"==Ysym&&(mirY[e]=1),1==mirXY[e]&&(Xsym="ON",Ysym="ON"),"ON"==Ysym&"ON"==Xsym&&(mirXY[e]=1),(new THREE.LoadingManager).onProgress=function(e,o,t){};console.log(retrievedObjectA[0].possiX[e]," possi "),vv0x[e]=retrievedObjectA[0].vv0x[e],vv0y[e]=retrievedObjectA[0].vv0y[e],vv0z[e]=retrievedObjectA[0].vv0z[e],vv1x[e]=retrievedObjectA[0].vv1x[e],vv1y[e]=retrievedObjectA[0].vv1y[e],vv1z[e]=retrievedObjectA[0].vv1z[e],vv2x[e]=retrievedObjectA[0].vv2x[e],vv2y[e]=retrievedObjectA[0].vv2y[e],vv2z[e]=retrievedObjectA[0].vv2z[e],vv3x[e]=retrievedObjectA[0].vv3x[e],vv3y[e]=retrievedObjectA[0].vv3y[e],vv3z[e]=retrievedObjectA[0].vv3z[e],console.log(vv0x[e]," x ",vv3z," z ",vv2y," y ");var a=new THREE.Geometry,r=vv0y+vv1y+vv2y+vv3y,i=vv0x+vv1x+vv2x+vv3x;if(a.vertices=[new THREE.Vector3(vv0x[e],vv0y[e],vv0z[e]),new THREE.Vector3(vv1x[e],vv1y[e],vv1z[e]),new THREE.Vector3(vv2x[e],vv2y[e],vv2z[e]),new THREE.Vector3(vv3x[e],vv3y[e],vv3z[e])],a.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],a.computeFaceNormals(),octa=new THREE.Mesh(a,material11),console.log(e+"octa------------cii"),octa.name=e,octa.userData="NONO",scene.add(octa),targetList.push(octa),.8<Math.abs(xi)&"ON"==Xsym){a=new THREE.Geometry,i=vv0x+vv1x+vv2x+vv3x;a.vertices=[new THREE.Vector3(-vv0x,vv0y,vv0z),new THREE.Vector3(-vv1x,vv1y,vv1z),new THREE.Vector3(-vv2x,vv2y,vv2z),new THREE.Vector3(-vv3x,vv3y,vv3z)],a.faces=[new THREE.Face3(0,1,2),new THREE.Face3(3,2,1),new THREE.Face3(2,3,0),new THREE.Face3(1,0,3)],octaX=new THREE.Mesh(a,material11),octaX.name=e+1e3,octaX.userData="NONO",scene.add(octaX),targetList.push(octaX)}if(.8<Math.abs(yi)&"ON"==Ysym){a=new THREE.Geometry,r=vv0y+vv1y+vv2y+vv3y;a.vertices=[new THREE.Vector3(vv0x,-vv0y,vv0z),new THREE.Vector3(vv1x,-vv1y,vv1z),new THREE.Vector3(vv2x,-vv2y,vv2z),new THREE.Vector3(vv3x,-vv3y,vv3z)],a.faces=[new THREE.Face3(0,1,2),new THREE.Face3(3,2,1),new THREE.Face3(2,3,0),new THREE.Face3(1,0,3)],octaY=new THREE.Mesh(a,material11),octaY.name=e+2e3,scene.add(octaY),octaY.userData="NONO",targetList.push(octaY)}if("ON"==Xsym&"ON"==Ysym){a=new THREE.Geometry,r=vv0y+vv1y+vv2y+vv3y,i=vv0x+vv1x+vv2x+vv3x;a.vertices=[new THREE.Vector3(-vv0x,-vv0y,vv0z),new THREE.Vector3(-vv1x,-vv1y,vv1z),new THREE.Vector3(-vv2x,-vv2y,vv2z),new THREE.Vector3(-vv3x,-vv3y,vv3z)],a.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],.1<i&r<-.1&&(a.faces=[new THREE.Face3(0,1,2),new THREE.Face3(3,2,1),new THREE.Face3(2,3,0),new THREE.Face3(1,0,3)]),i<-.1&.1<r&&(a.faces=[new THREE.Face3(0,1,2),new THREE.Face3(3,2,1),new THREE.Face3(2,3,0),new THREE.Face3(1,0,3)]),i<-.1&r<-.1&&(a.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)]),a.computeFaceNormals(),octaXY=new THREE.Mesh(a,material11),octaXY.name=e+3e3,octaXY.userData="NONO",scene.add(octaXY),targetList.push(octaXY)}scene.traverse(function(e){e instanceof THREE.Object3D&&(e.userData="NONO")})}function addTetraL(t){var a=retrievedObjectA[0].possiX[t],r=retrievedObjectA[0].possiY[t],i=retrievedObjectA[0].possiZ[t],e=(retrievedObjectA[0].rotX[t],retrievedObjectA[0].rotY[t],retrievedObjectA[0].rotZ[t],new THREE.LoadingManager);e.onProgress=function(e,o,t){};console.log(retrievedObjectA[0].possiX[t]," possi "),42<addTetraFlag&&(addTetraFlag=0),-1!=addTetraFlag&&new THREE.OBJLoader(e).load(designs[addTetraFlag],function(e){e.traverse(function(e){}),e.scale.x=.99,e.scale.y=.99,e.scale.z=.99,objects[t]=e.clone(),console.log(t,"objectsload"),xi=retrievedObjectA[0].possiX[t],yi=retrievedObjectA[0].possiY[t],zi=retrievedObjectA[0].possiZ[t],angleObx=retrievedObjectA[0].rotX[t],angleOby=retrievedObjectA[0].rotY[t],angleObz=retrievedObjectA[0].rotZ[t];var o=Math.PI;Math.floor(window.innerWidth/1910),window.innerHeight;objects[t].position.applyMatrix4(camera.matrixWorld),objects[t].position.x=a,objects[t].position.z=i,objects[t].position.y=r,objects[t].position.y=yi,objects[t].position.z=zi,objects[t].position.x=xi,objects[t].rotation.x=angleObx+o,objects[t].rotation.y=angleOby,objects[t].rotation.z=angleObz,objects[t].name=t,objects[t].userData=t,objects[t].userSTL="Y",objects[t].userCol=TColour[t],scene.add(objects[t]),objects[t].rotation.z=angleObz,1==mirX[t]&&(Xsym="ON"),"ON"==Xsym&&(console.log("YayMirX!"),mirX[t]=1),1==mirY[t]&&(Ysym="ON"),"ON"==Ysym&&(mirY[t]=1),1==mirXY[t]&&(Xsym="ON",Ysym="ON"),"ON"==Ysym&"ON"==Xsym&&(mirXY[t]=1),console.log(t+"numbr"+objects[t].nameX+"Yay"),console.log(t+"numbr"+objects[t].name+"Nay"),targetOBJ.push(objects[t].name),TColour[t]=("000000"+material15.color.getHex().toString(16)).slice(-6),console.log(Xsym),.8<Math.abs(xi)&"ON"==Xsym&&(objects[t+1e3]=e.clone(),lambert=new THREE.MeshLambertMaterial({color:TColour[t].color,map:texture2}),objects[t+1e3].traverse(function(e){}),objects[t+1e3].position.y=yi,objects[t+1e3].position.z=zi,objects[t+1e3].position.x=-xi,objects[t+1e3].rotation.x=angleObx,objects[t+1e3].rotation.y=-angleOby,objects[t+1e3].rotation.z=angleObz,objects[t+1e3].name=t+1e3,objects[t+1e3].userData=t+1e3,scene.add(objects[t+1e3]),objects[t+1e3].userCol=TColour[t],console.log(t+"numbr"+objects[t+1e3].name),targetOBJ.push(objects[t+1e3])),.8<Math.abs(yi)&"ON"==Ysym&&(objects[t+2e3]=e.clone(),lambert=new THREE.MeshLambertMaterial({color:TColour[t].color,map:texture2}),objects[t+2e3].traverse(function(e){}),objects[t+2e3].position.y=-yi,objects[t+2e3].position.z=zi,objects[t+2e3].position.x=xi,objects[t+2e3].rotation.x=-angleObx,objects[t+2e3].rotation.y=angleOby,objects[t+2e3].rotation.z=angleObz,objects[t+2e3].name=t+2e3,objects[t+2e3].userData=t+2e3,scene.add(objects[t+2e3]),objects[t+2e3].userCol=TColour[t],console.log(t+"numbr"+objects[t+2e3].name),targetOBJ.push(objects[t+2e3])),.8<Math.abs(yi)&.8<Math.abs(xi)&"ON"==Xsym&"ON"==Ysym&&(objects[t+3e3]=e.clone(),lambert=new THREE.MeshLambertMaterial({color:TColour[t].color,map:texture2}),objects[t+3e3].traverse(function(e){}),objects[t+3e3].position.y=-yi,objects[t+3e3].position.z=zi,objects[t+3e3].position.x=-xi,objects[t+3e3].rotation.x=-angleObx,objects[t+3e3].rotation.y=-angleOby,objects[t+3e3].rotation.z=angleObz,objects[t+3e3].name=t+3e3,objects[t+3e3].userData=t+3e3,objects[t+3e3].userCol=TColour[t],scene.add(objects[t+3e3]),scene3.add(objects[t+3e3]),console.log(t+"numbr"+objects[t+3e3].name),targetOBJ.push(objects[t+3e3])),objects[t].name=t,targetOBJ.push(objects[t].name)},function(e){if(e.lengthComputable)e.loaded,e.total},function(e){})}function addTetraF(){texture2=(new THREE.TextureLoader).load(textures[texFlag]),new THREE.ImageLoader(e).load(textures[texFlag],function(e){}),texture2.offset.set(-2.275,-.7),texture2.repeat.set(3.7,3),lambert=new THREE.MeshLambertMaterial({color:1127338,map:texture2,side:THREE.DoubleSide});var e=new THREE.LoadingManager;e.onProgress=function(e,o,t){};new THREE.TextureLoader;var t=objects[1].position.x,a=objects[1].position.y,r=objects[1].position.z;scene.remove(objects[1]),camera.remove(objects[1]);camera.position.x,camera.position.y,camera.position.z;42<addTetraFlag&&(addTetraFlag=0),-1!=addTetraFlag&&new THREE.OBJLoader(e).load(designs[addTetraFlag],function(e){e.material=lambert,e.traverse(function(e){e.material=new THREE.MeshLambertMaterial({color:material15.color,transparent:!0,opacity:.9})}),e.scale.x=.99,e.scale.y=.99,e.scale.z=.99,objects[1]=e.clone(),objects[1].material=e.material.clone(),object2=e.clone(),object2.material=e.material.clone();var o=Math.PI;Math.floor(window.innerWidth/1910),window.innerHeight;objects[1].scale.x=.9,objects[1].scale.y=.9,objects[1].scale.z=.9,objects[1].position.applyMatrix4(camera.matrixWorld),objects[1].position.x=t,objects[1].position.z=r,objects[1].position.y=a,objects[1].rotation.x=o,scene.add(objects[1]),camera.add(objects[1]),console.log("  numbrx Design "+designs[addTetraFlag]),targetOBJ.push(objects[1]);new THREE.MeshLambertMaterial({color:16711680,vertexColors:THREE.FaceColors,shading:THREE.FlatShading,polygonOffset:!0,polygonOffsetUnits:1,polygonOffsetFactor:1});scene.add(octa),targetList.push(octa),TColour[cii]=("000000"+material15.color.getHex().toString(16)).slice(-6)},function(e){if(e.lengthComputable)e.loaded,e.total},function(e){})}function isOdd(e){return e%2}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function onDocumentMouseMove(e){mouse.x=e.clientX/window.innerWidth*2-1,mouse.y=-e.clientY/window.innerHeight*2+1,mouseX=mouse.x,mouseY=mouse.y}function onDocumentMouseDown(e){switch(console.log("Click."),e.button){case 0:Tadd=1,0==TaddD&&(Tadd=0),console.log(TaddD+" TaddD");case 1:break;case 2:Tadd=0}mouse.x=e.clientX/window.innerWidth*2-1,mouse.y=-e.clientY/window.innerHeight*2+1,checkSelection()}function checkSelection(){var e=new THREE.Vector3(mouse.x,mouse.y,.999);e.unproject(camera);var o=new THREE.Raycaster(camera.position,e.sub(camera.position).normalize()).intersectObjects(targetList);if(0<o.length&1==Tadd){console.log("function checkSelection(){"+cii);var t=INTERSECTED.object.geometry,a=INTERSECTED.face,r=(a.normal.x,a.normal.y,a.normal.z,t.vertices),i=r[0],c=r[1],n=r[2],s=r[3];if(a.a+a.b+a.c==6){var l=c,E=new THREE.Vector3((n.x+s.x)/2+((n.x+s.x)/2-i.x),(n.y+s.y)/2+((n.y+s.y)/2-i.y),(n.z+s.z)/2+(n.z+s.z)/2-i.z),d=n,m=s;console.log("Face 6 @ "+m.x)}if(a.a+a.b+a.c==5){l=new THREE.Vector3((s.x+n.x)/2+((s.x+n.x)/2-c.x),(s.y+n.y)/2+((s.y+n.y)/2-c.y),(s.z+n.z)/2+(s.z+n.z)/2-c.z),E=i,d=n,m=s;console.log("Face 5 @ "+l.x+" "+E.x)}if(a.a+a.b+a.c==4){l=i,E=c,d=s,m=new THREE.Vector3((i.x+c.x)/2+((i.x+c.x)/2-n.x),(i.y+c.y)/2+((i.y+c.y)/2-n.y),(i.z+c.z)/2+(i.z+c.z)/2-n.z);console.log("Face 4 @ "+l.x)}if(a.a+a.b+a.c==3){l=i,E=c,d=new THREE.Vector3((i.x+c.x)/2+((i.x+c.x)/2-s.x),(i.y+c.y)/2+((i.y+c.y)/2-s.y),(i.z+c.z)/2+(i.z+c.z)/2-s.z),m=n;console.log("Face 3 @ "+l.x)}sx=i.x+c.x+n.x+s.x,sy=i.y+c.y+n.y+s.y,sz=i.z+c.z+n.z+s.z,xi=(l.x+E.x+d.x+m.x)/4,yi=(l.y+E.y+d.y+m.y)/4,zi=(l.z+E.z+d.z+m.z)/4,angleObx=0,angleOby=0,angleObz=0;var T=Math.PI;xi/4==Math.floor(xi/4)&(yi-1)/4==Math.floor((yi-1)/4)&(zi-3)/4==Math.floor((zi-3)/4)&&(angleObx=T/2,console.log("gggggggggg66666666666666")),(xi+2)/4==Math.floor((xi+2)/4)&(yi-2)/4==Math.floor((yi-2)/4)&zi/4==Math.floor(zi/4)&&(angleObx=T,console.log("gggggggggg4444444444444444")),(xi-2)/4==Math.floor((xi-2)/4)&(yi-3)/4==Math.floor((yi-3)/4)&(zi-3)/4==Math.floor((zi-3)/4)&&(angleObx=T/2,console.log("ggggggggggg1111111111111111111")),(xi-2)/4==Math.floor((xi-2)/4)&(yi-1)/4==Math.floor((yi-1)/4)&(zi-3)/4==Math.floor((zi-3)/4)&&(angleObx=T/2,angleObz=T/2,console.log("ffffffff888888888888888888")),xi/4==Math.floor(xi/4)&yi/4==Math.floor(yi/4)&(zi-2)/4==Math.floor((zi-2)/4)&&(angleObz=T,console.log("ffffffff7777777777777777777")),(xi-3)/4==Math.floor((xi-3)/4)&yi/4==Math.floor(yi/4)&(zi-3)/4==Math.floor((zi-3)/4)&&(angleOby=-T/2,console.log("fffffffffff555555555555555")),(xi-3)/4==Math.floor((xi-3)/4)&(yi-2)/4==Math.floor((yi-2)/4)&(zi-1)/4==Math.floor((zi-1)/4)&&(angleObx=T/2,angleOby=-T/2,console.log("fffffffffff444444444444")),(xi-1)/4==Math.floor((xi-1)/4)&(yi-2)/4==Math.floor((yi-2)/4)&(zi-1)/4==Math.floor((zi-1)/4)&&(angleOby=-T/2,console.log("ffffffffff666666666666666666")),(xi-1)/4==Math.floor((xi-1)/4)&yi/4==Math.floor(yi/4)&(zi-3)/4==Math.floor((zi-3)/4)&&(angleOby=T/2,console.log("ffffffffff666666666666666666")),xi/4==Math.floor(xi/4)&(yi-3)/4==Math.floor((yi-3)/4)&(zi-1)/4==Math.floor((zi-1)/4)&&(angleObx=T/2,angleOby=T,console.log("ffffffff3333333333333")),xi/4==Math.floor(xi/4)&yi/4==Math.floor(yi/4)&(zi+2)/4==Math.floor((zi+2)/4)&&(angleObx=T),xi/4==Math.floor(xi/4)&(yi-1)/4==Math.floor((yi-1)/4)&(zi-1)/4==Math.floor((zi-1)/4)&&(angleObx=T/2,console.log("fff000000000000000000000000")),1==cii&&camera.remove(objects[3]),console.log(l," vvo etc ",E,"   vv1",d,"   vv2  ",m),cii+=1,addTNew(l,E,d,m)}if(0<o.length&0==Tadd){o[0];INTERSECTED.object.geometry.computeBoundingSphere();var v=INTERSECTED.object.geometry.boundingSphere.center;if(.8<Math.abs(v.x)&&(console.log(INTERSECTED.object.name+"---A-------delete this"+mirX[5]),1==mirX[INTERSECTED.object.name])){console.log(INTERSECTED.object.name+"   B  "+v.x+"-xxxx---------delete this");var b=INTERSECTED.object.name+1e3;rotXX[b-1e3]="NA",scene.remove(objects[b])}if(.2<Math.abs(v.y)&&1==mirY[INTERSECTED.object.name]){console.log(INTERSECTED.object.name+"   B  "+v.x+"-xxxxSS---------delete this");var w=INTERSECTED.object.name+2e3;rotYY[w-2e3]="NA",scene.remove(objects[w])}if(.2<Math.abs(v.y)&.8<Math.abs(v.x)&&1==mirY[INTERSECTED.object.name]&1==mirX[INTERSECTED.object.name]){console.log(INTERSECTED.object.name+"   B  "+v.x+"-xxxxSS---------delete this");var R=INTERSECTED.object.name+3e3;rotXY[R-3e3]="NA",scene.remove(objects[R])}rotX[INTERSECTED.object.name]="NA",scene.remove(objects[INTERSECTED.object.name]),targetList.splice(targetList.indexOf(INTERSECTED.object),1),console.log(INTERSECTED.object.name+"     "+v.x+"-xxxx-----G----delete this")}}function addTNew(e,o,t,a){if(console.log("addTNew(vv0,vv1,vv2,vv3)"),materials[cii]=material15,objects[cii]=object2.clone(),objects[cii].material=object2.material.clone(),"Random"==Rainbow){("000000"+materials[cii].color.getHex().toString(16)).slice(-6);var r=Math.floor(98.9*Math.random()+1)+100*Math.floor(98.9*Math.random()+1)+1e4*Math.floor(98.9*Math.random()+1);console.log("nextcolour "+r),materials[cii].color.setHex("0x"+r)}if("Greys"==Rainbow){var i=Math.min(Math.floor(4*Math.random()+59),60).toString(16);r="88";materials[cii].color.setHex("0x"+i+i+r)}if("Greens"==Rainbow){i=Math.floor(80*Math.random()+17).toString(16),r="ff";materials[cii].color.setHex("0x"+i+r+i)}if("Reds"==Rainbow){i=Math.floor(80*Math.random()+17).toString(16),r="ff";materials[cii].color.setHex("0x"+r+i+i)}if("Blues"==Rainbow){i=Math.floor(80*Math.random()+17).toString(16),r="ff";materials[cii].color.setHex("0x"+i+i+r)}"Yellow/Blue"==Rainbow&&(materials[cii].color.setHex(colcol),"0x2222cc"==colcol?colcol="0x555500":colcol="0x2222cc",materials[cii].color.setHex(colcol)),lambert=new THREE.MeshLambertMaterial({color:materials[cii].color,map:texture2}),objects[cii].traverse(function(e){e.material=lambert}),1==loadingF&&(xi=retrievedObjectA[0].possiX[cii],yi=retrievedObjectA[0].possiY[cii],zi=retrievedObjectA[0].possiZ[cii],angleObx=retrievedObjectA[0].rotX[cii],angleOby=retrievedObjectA[0].rotY[cii],angleObz=retrievedObjectA[0].rotZ[cii],loadingF=0),objects[cii].position.y=yi,objects[cii].position.z=zi,objects[cii].position.x=xi,possiX[cii]=xi,possiY[cii]=yi,possiZ[cii]=zi,TFlagNum[cii]=addTetraFlag,objects[cii].rotation.x=angleObx,objects[cii].rotation.y=angleOby,objects[cii].rotation.z=angleObz,rotX[cii]=angleObx,rotY[cii]=angleOby,rotZ[cii]=angleObz,scene.add(objects[cii]),1==mirX[cii]&&(Xsym="ON"),"ON"==Xsym&&(console.log("YayMirX!"),mirX[cii]=1),1==mirY[cii]&&(Ysym="ON"),"ON"==Ysym&&(mirY[cii]=1),1==mirXY[cii]&&(Xsym="ON",Ysym="ON"),"ON"==Ysym&"ON"==Xsym&&(mirXY[cii]=1),objects[cii].userData="P",objects[cii].userSTL="Y",objects[cii].userCol=TColour[cii],console.log(cii+"numbr"+objects[cii].nameX+"Yay"),console.log(cii+"numbr"+objects[cii].name+"Nay"),targetOBJ.push(objects[cii].name),TColour[cii]=("000000"+material15.color.getHex().toString(16)).slice(-6),console.log(Xsym),.8<Math.abs(xi)&"ON"==Xsym?(objects[cii+1e3]=object2.clone(),objects[cii+1e3].material=object2.material.clone(),lambert=new THREE.MeshLambertMaterial({color:materials[cii].color,map:texture2}),objects[cii+1e3].traverse(function(e){e.material=lambert}),objects[cii+1e3].position.y=yi,objects[cii+1e3].position.z=zi,objects[cii+1e3].position.x=-xi,objects[cii+1e3].rotation.x=angleObx,objects[cii+1e3].rotation.y=-angleOby,objects[cii+1e3].rotation.z=angleObz,possiYX[cii]=yi,possiZX[cii]=zi,possiXX[cii]=-xi,TFlagNumX[cii]=addTetraFlag,TColourX[cii]=("000000"+lambert.color.getHex().toString(16)).slice(-6),rotXX[cii]=angleObx,rotYX[cii]=-angleOby,rotZX[cii]=angleObz,scene.add(objects[cii+1e3]),objects[cii+1e3].name=cii+1e3,objects[cii+1e3].userData="P",console.log(cii+"numbr"+objects[cii+1e3].name),targetOBJ.push(objects[cii+1e3])):(possiYX[cii]="NA",possiZX[cii]="NA",possiXX[cii]="NA",TFlagNumX[cii]="NA",TColourX[cii]="NA",rotXX[cii]="NA",rotYX[cii]="NA",rotZX[cii]="NA"),.8<Math.abs(yi)&"ON"==Ysym?(objects[cii+2e3]=object2.clone(),objects[cii+2e3].material=object2.material.clone(),lambert=new THREE.MeshLambertMaterial({color:materials[cii].color,map:texture2}),objects[cii+2e3].traverse(function(e){e.material=lambert}),objects[cii+2e3].position.y=-yi,objects[cii+2e3].position.z=zi,objects[cii+2e3].position.x=xi,objects[cii+2e3].rotation.x=-angleObx,objects[cii+2e3].rotation.y=angleOby,objects[cii+2e3].rotation.z=angleObz,possiYY[cii]=-yi,possiZY[cii]=zi,possiXY[cii]=xi,TFlagNumY[cii]=addTetraFlag,TColourY[cii]=("000000"+lambert.color.getHex().toString(16)).slice(-6),rotXY[cii]=-angleObx,rotYY[cii]=angleOby,rotZY[cii]=angleObz,scene.add(objects[cii+2e3]),objects[cii+2e3].name=cii+2e3,objects[cii+2e3].userData="P",console.log(cii+"numbr"+objects[cii+2e3].name),targetOBJ.push(objects[cii+2e3])):(possiYY[cii]="NA",possiZY[cii]="NA",possiXY[cii]="NA",TFlagNumY[cii]="NA",TColourY[cii]="NA",rotXY[cii]="NA",rotYY[cii]="NA",rotZY[cii]="NA"),.8<Math.abs(yi)&.8<Math.abs(xi)&"ON"==Xsym&"ON"==Ysym?(objects[cii+3e3]=object2.clone(),objects[cii+3e3].material=object2.material.clone(),lambert=new THREE.MeshLambertMaterial({color:materials[cii].color,map:texture2}),objects[cii+3e3].traverse(function(e){e.material=lambert}),objects[cii+3e3].position.y=-yi,objects[cii+3e3].position.z=zi,objects[cii+3e3].position.x=-xi,objects[cii+3e3].rotation.x=-angleObx,objects[cii+3e3].rotation.y=-angleOby,objects[cii+3e3].rotation.z=angleObz,possiYXY[cii]=-yi,possiZXY[cii]=zi,possiXXY[cii]=-xi,TFlagNumXY[cii]=addTetraFlag,TColourXY[cii]=("000000"+lambert.color.getHex().toString(16)).slice(-6),rotXXY[cii]=-angleObx,rotYXY[cii]=-angleOby,rotZXY[cii]=angleObz,scene.add(objects[cii+3e3]),objects[cii+3e3].name=cii+3e3,objects[cii+3e3].userData="P",console.log(cii+"numbr"+objects[cii+3e3].name),targetOBJ.push(objects[cii+3e3])):(possiYXY[cii]="NA",possiZXY[cii]="NA",possiXXY[cii]="NA",TFlagNumXY[cii]="NA",TColourXY[cii]="NA",rotXXY[cii]="NA",rotYXY[cii]="NA",rotZXY[cii]="NA"),console.log(cii+"numbr and xvalue ="+xi);var c=new THREE.Geometry,n=e.y+o.y+t.y+a.y,s=e.x+o.x+t.x+a.x;if(vv0x[cii]=e.x,console.log(cii+"vv0x ="+e.x),vv0y[cii]=e.y,vv0z[cii]=e.z,vv1x[cii]=o.x,vv1y[cii]=o.y,vv1z[cii]=o.z,vv2x[cii]=t.x,vv2y[cii]=t.y,vv2z[cii]=t.z,vv3x[cii]=a.x,vv3y[cii]=a.y,vv3z[cii]=a.z,c.vertices=[new THREE.Vector3(e.x,e.y,e.z),new THREE.Vector3(o.x,o.y,o.z),new THREE.Vector3(t.x,t.y,t.z),new THREE.Vector3(a.x,a.y,a.z)],c.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],c.computeFaceNormals(),octa=new THREE.Mesh(c,material11),console.log(cii+"octa------------cii"),octa.name=cii,scene.add(octa),targetList.push(octa),.8<Math.abs(xi)&"ON"==Xsym){c=new THREE.Geometry,s=e.x+o.x+t.x+a.x;c.vertices=[new THREE.Vector3(-e.x,e.y,e.z),new THREE.Vector3(-o.x,o.y,o.z),new THREE.Vector3(-t.x,t.y,t.z),new THREE.Vector3(-a.x,a.y,a.z)],c.faces=[new THREE.Face3(0,1,2),new THREE.Face3(3,2,1),new THREE.Face3(2,3,0),new THREE.Face3(1,0,3)],octaX=new THREE.Mesh(c,material11),octaX.name=cii+1e3,scene.add(octaX),targetList.push(octaX)}if(.8<Math.abs(yi)&"ON"==Ysym){c=new THREE.Geometry,n=e.y+o.y+t.y+a.y;c.vertices=[new THREE.Vector3(e.x,-e.y,e.z),new THREE.Vector3(o.x,-o.y,o.z),new THREE.Vector3(t.x,-t.y,t.z),new THREE.Vector3(a.x,-a.y,a.z)],c.faces=[new THREE.Face3(0,1,2),new THREE.Face3(3,2,1),new THREE.Face3(2,3,0),new THREE.Face3(1,0,3)],octaY=new THREE.Mesh(c,material11),octaY.name=cii+2e3,scene.add(octaY),targetList.push(octaY)}if("ON"==Xsym&"ON"==Ysym){c=new THREE.Geometry,n=e.y+o.y+t.y+a.y,s=e.x+o.x+t.x+a.x;c.vertices=[new THREE.Vector3(-e.x,-e.y,e.z),new THREE.Vector3(-o.x,-o.y,o.z),new THREE.Vector3(-t.x,-t.y,t.z),new THREE.Vector3(-a.x,-a.y,a.z)],c.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)],.1<s&n<-.1&&(c.faces=[new THREE.Face3(0,1,2),new THREE.Face3(3,2,1),new THREE.Face3(2,3,0),new THREE.Face3(1,0,3)]),s<-.1&.1<n&&(c.faces=[new THREE.Face3(0,1,2),new THREE.Face3(3,2,1),new THREE.Face3(2,3,0),new THREE.Face3(1,0,3)]),s<-.1&n<-.1&&(c.faces=[new THREE.Face3(2,1,0),new THREE.Face3(1,2,3),new THREE.Face3(0,3,2),new THREE.Face3(3,0,1)]),c.computeFaceNormals(),octaXY=new THREE.Mesh(c,material11),octaXY.name=cii+3e3,scene.add(octaXY),targetList.push(octaXY)}}function onDocumentKeyDown(e){switch(e.keyCode){case 16:isShiftDown=!0}}function onDocumentKeyUp(e){switch(e.keyCode){case 16:isShiftDown=!1}}function animate(){requestAnimationFrame(animate),render(),update()}function flyTrack(){var e=camera,o=window.innerWidth/window.innerHeight;camera=new THREE.PerspectiveCamera(45,o,.01,2e4),camera.position.copy(e.position),camera.rotation.copy(e.rotation);var t=0,a=1;switch(mode){case a:controls=new THREE.TrackballControls(camera),mode=t;break;case t:controls=new THREE.FlyControls(camera),mode=a}}function update(){keyboard.update();var e=Math.PI;keyboard.pressed("A")&&(objects[1].traverse(function(e){e.material=lambert}),objects[cii].traverse(function(e){e.material=lambert}),console.log("APressed")),keyboard.pressed("left")&&(objects[1].position.x=objects[1].position.x-.5,objects[999].position.x=objects[999].position.x-.5,console.log("leftPressed")),keyboard.pressed("right")&&(objects[1].position.x=objects[1].position.x+.5,objects[999].position.x=objects[999].position.x+.5,console.log("rightPressed")),keyboard.pressed("down")&&(objects[1].position.y=objects[1].position.y-.5,objects[999].position.y=objects[999].position.y-.5,console.log("downPressed")),keyboard.pressed("up")&&(objects[1].position.y=objects[1].position.y+.5,objects[999].position.y=objects[999].position.y+.5,console.log("upPressed"));if(keyboard.pressed("X")){var o=objects[cii].rotation.x;console.log("upPressed"),setTimeout(function(){objects[cii].rotation.x=o+e/2},300)}if(keyboard.pressed("Y")){o=objects[cii].rotation.y;setTimeout(function(){objects[cii].rotation.y=o+e/2},300)}if(keyboard.pressed("Z")){o=objects[cii].rotation.z;setTimeout(function(){objects[cii].rotation.z=o+e/2},300)}if(keyboard.pressed("F")){for(o=0;o<=10;o+=1)var t=o;addTetraFlag=addTetraFlag+1+t,addTetraFlag-=t,addTetraF()}keyboard.pressed("B")&&(separation+=.1),keyboard.pressed("B")&&(separation-=.1),objects[1].rotation.z=objects[1].rotation.z+.01,objects[1].rotation.x=objects[1].rotation.x+0,objects[1].rotation.x>2*Math.PI&&(objects[1].rotation.x=.005),objects[1].rotation.z>2*Math.PI&&(objects[1].rotation.z=.01),objects[1].traverse(function(e){e.material=lambert}),controls.update(),checkHighlight(),CheckMouseSphere()}function checkHighlight(){var e=new THREE.Vector3(mouse.x,mouse.y,.999);e.unproject(camera);var o=new THREE.Raycaster(camera.position,e.sub(camera.position).normalize()).intersectObjects(targetList);0<o.length?(null==INTERSECTED||(INTERSECTED.face.color=baseColor,INTERSECTED.object.geometry.colorsNeedUpdate=!0),INTERSECTED=o[0],INTERSECTED.face.color=cubeColor,mouseSphereCoords=[INTERSECTED.point.x,INTERSECTED.point.y,INTERSECTED.point.z],INTERSECTED.object.geometry.colorsNeedUpdate=!0):(INTERSECTED&&(INTERSECTED.face.color=baseColor,INTERSECTED.object.geometry.colorsNeedUpdate=!0),INTERSECTED=null,mouseSphereCoords=null)}function checkRotation(){var e=camera.position.x,o=(camera.position.y,camera.position.z);keyboard.pressed("left")?(camera.position.x=e*Math.cos(rotSpeed)+o*Math.sin(rotSpeed),camera.position.z=o*Math.cos(rotSpeed)-e*Math.sin(rotSpeed)):keyboard.pressed("right")&&(camera.position.x=e*Math.cos(rotSpeed)-o*Math.sin(rotSpeed),camera.position.z=o*Math.cos(rotSpeed)+e*Math.sin(rotSpeed)),camera.lookAt(scene.position)}function CheckMouseSphere(){null!=mouseSphereCoords?(mouseSphere[0].position.set(mouseSphereCoords[0],mouseSphereCoords[1],mouseSphereCoords[2]),mouseSphere[0].visible=!0):(mouseSphere[0].visible=!1,xxx=0)}function render(){keyboard.update();Math.PI;"OFF"==Doption&&(renderer.clear(),camera.up=new THREE.Vector3(0,1,0),renderer.render(scene,camera)),"Anaglyph"==Doption&&anaglyphRenderer.render(scene,camera),"Side-by-Side"==Doption&&OcRenderer.render(scene,camera)}objects1.on("click",function(){exportToObj()});
